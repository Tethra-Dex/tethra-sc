Compiling 1 files with Solc 0.8.20
Solc 0.8.20 finished in 22.77s
Compiler run successful with warnings:
Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
   --> src/risk/RiskManager.sol:205:106:
    |
205 |     function validateTrade(address trader, string calldata symbol, uint256 leverage, uint256 collateral, bool isLong)
    |                                                                                                          ^^^^^^^^^^^

Warning (5667): Unused function parameter. Remove or comment out the variable name to silence this warning.
   --> src/risk/RiskManager.sol:246:9:
    |
246 |         uint256 positionId,
    |         ^^^^^^^^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> src/trading/MarketExecutor.sol:176:9:
    |
176 |         uint256 fee = (positionSize * tradingFeeBps) / 100000;
    |         ^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> src/trading/MarketExecutor.sol:233:9:
    |
233 |         uint256 positionSize = collateral * leverage;
    |         ^^^^^^^^^^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> src/trading/MarketExecutor.sol:258:50:
    |
258 |         (, address trader, string memory symbol, bool isLong, uint256 collateral, uint256 size,,,, uint8 status) =
    |                                                  ^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> src/trading/MarketExecutor.sol:294:58:
    |
294 |         (, address positionTrader, string memory symbol, bool isLong, uint256 collateral, uint256 size,,,, uint8 status)
    |                                                          ^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> src/trading/MarketExecutor.sol:338:13:
    |
338 |             address trader,
    |             ^^^^^^^^^^^^^^

Warning (2018): Function state mutability can be restricted to pure
   --> src/risk/RiskManager.sol:245:5:
    |
245 |     function shouldLiquidate(
    |     ^ (Relevant source part starts here and spans across multiple lines).

[2m2025-10-14T18:33:33.627972Z[0m [33m WARN[0m [2mtraces::etherscan[0m[2m:[0m etherscan config not found

Ran 15 tests for test/LimitExecutor.t.sol:LimitExecutorTest
[PASS] testCancelLimitOrder() (gas: 359438)
[PASS] testCannotCancelOthersOrder() (gas: 320014)
[PASS] testCannotCreateOrderWithoutApproval() (gas: 27315)
[PASS] testCannotCreateOrderWithoutFunds() (gas: 26629)
[FAIL: Error != expected error: ECDSAInvalidSignatureLength(1) != LimitExecutor: Price not reached (long)] testCannotExecuteBeforePriceReaches_Long() (gas: 351329)
[PASS] testCreateLimitOpenOrder_Long() (gas: 324625)
[PASS] testCreateLimitOpenOrder_Short() (gas: 298273)
[FAIL: ECDSAInvalidSignatureLength(1)] testCreateStopLossOrder() (gas: 350872)
[FAIL: ECDSAInvalidSignatureLength(1)] testCreateTakeProfitOrder() (gas: 351514)
[FAIL: log != expected log] testExecuteLimitOpenOrder_Long() (gas: 354014)
[FAIL: ECDSAInvalidSignatureLength(1)] testExecuteLimitOpenOrder_Short() (gas: 331297)
[FAIL: ECDSAInvalidSignatureLength(1)] testExecuteStopLoss_LongPosition() (gas: 350682)
[FAIL: ECDSAInvalidSignatureLength(1)] testExecuteTakeProfit_LongPosition() (gas: 350937)
[PASS] testGetUserOrders() (gas: 736408)
[PASS] testMultipleTraders() (gas: 774659)
Suite result: FAILED. 8 passed; 7 failed; 0 skipped; finished in 4.45ms (2.79ms CPU time)

Ran 2 tests for test/Counter.t.sol:CounterTest
[PASS] testFuzz_SetNumber(uint256) (runs: 256, Î¼: 28177, ~: 28411)
[PASS] test_Increment() (gas: 28436)
Suite result: ok. 2 passed; 0 failed; 0 skipped; finished in 4.47ms (4.36ms CPU time)

Ran 10 tests for test/MarketExecutor.t.sol:MarketExecutorTest
[PASS] testOpenMarketPosition_ExpiredPrice() (gas: 22528)
[PASS] testOpenMarketPosition_FutureTimestamp() (gas: 21880)
[PASS] testOpenMarketPosition_InvalidLeverage() (gas: 45953)
[PASS] testOpenMarketPosition_InvalidSignature() (gas: 26344)
[PASS] testOpenMarketPosition_LongPullsCollateralOnly() (gas: 353178)
[PASS] testSettlementCapsLossAtNinetyNinePercent() (gas: 133618)
[PASS] testSettlementHandlesProfit() (gas: 129003)
[PASS] testUpdateFees() (gas: 26245)
[PASS] testUpdateFees_LiquidationTooHigh() (gas: 11559)
[PASS] testUpdateFees_TradingTooHigh() (gas: 11295)
Suite result: ok. 10 passed; 0 failed; 0 skipped; finished in 7.72ms (7.06ms CPU time)

Ran 31 tests for test/RiskManager.t.sol:RiskManagerTest
[PASS] testCalculateLiquidationPrice_Long() (gas: 18160)
[PASS] testCalculateLiquidationPrice_Short() (gas: 17840)
[PASS] testCheckLiquidation_Long_ShouldLiquidate() (gas: 18513)
[PASS] testCheckLiquidation_Long_ShouldNotLiquidate() (gas: 18948)
[PASS] testCheckLiquidation_Short_ShouldLiquidate() (gas: 19123)
[PASS] testCheckLiquidation_Short_ShouldNotLiquidate() (gas: 18885)
[PASS] testDecreaseOpenInterest() (gas: 37762)
[PASS] testDecreaseOpenInterest_Underflow() (gas: 13693)
[PASS] testDeployment() (gas: 2524)
[PASS] testDisableAsset() (gas: 28496)
[PASS] testFuzz_LiquidationPrice(uint256,uint256) (runs: 256, Î¼: 24862, ~: 24865)
[PASS] testFuzz_ValidatePosition(uint256,uint8) (runs: 256, Î¼: 15075, ~: 24187)
[PASS] testIncreaseOpenInterest() (gas: 33681)
[PASS] testInvalidLeverage() (gas: 12147)
[PASS] testInvalidPositionSize() (gas: 11892)
[PASS] testInvalidThreshold() (gas: 15702)
[PASS] testMultipleAssets() (gas: 240967)
[PASS] testSetAssetConfig() (gas: 124181)
[PASS] testSetAssetConfigUnauthorized() (gas: 14271)
[FAIL: Loss below 99% should not liquidate] testShouldLiquidateRespectsBuffer() (gas: 10075)
[PASS] testShouldLiquidateTriggersAtNinetyNinePercentLoss() (gas: 7163)
[PASS] testValidatePosition_AssetNotEnabled() (gas: 20302)
[PASS] testValidatePosition_LeverageTooHigh() (gas: 20807)
[PASS] testValidatePosition_MaxOpenInterestExceeded() (gas: 48331)
[PASS] testValidatePosition_PositionTooLarge() (gas: 20107)
[PASS] testValidatePosition_SizeMismatch() (gas: 22457)
[PASS] testValidatePosition_Success() (gas: 20143)
[PASS] testValidateTradeInvalidCollateral() (gas: 19381)
[PASS] testValidateTradeInvalidLeverage() (gas: 20182)
[PASS] testValidateTradeMaxOpenInterestExceeded() (gas: 47176)
[PASS] testValidateTradeValid() (gas: 22684)
Suite result: FAILED. 30 passed; 1 failed; 0 skipped; finished in 20.26ms (35.62ms CPU time)

Ran 35 tests for test/TethraStaking.t.sol:TethraStakingTest
[PASS] testAddRewards() (gas: 204717)
[PASS] testAddRewards_InvalidAmount() (gas: 137198)
[PASS] testAddRewards_NoStakers() (gas: 48557)
[PASS] testCalculateAPR() (gas: 125386)
[PASS] testCalculateAPR_NoStakers() (gas: 8015)
[PASS] testClaimRewards() (gas: 272452)
[PASS] testClaimRewards_Multiple() (gas: 285537)
[PASS] testClaimRewards_NoRewards() (gas: 136859)
[PASS] testDeployment() (gas: 27369)
[PASS] testDeployment_InvalidTetra() (gas: 151185)
[PASS] testDeployment_InvalidUsdc() (gas: 151790)
[PASS] testEmergencyWithdraw() (gas: 42008)
[PASS] testEmergencyWithdraw_InvalidAddress() (gas: 13791)
[PASS] testEmergencyWithdraw_InvalidAmount() (gas: 15857)
[PASS] testEmergencyWithdraw_InvalidToken() (gas: 13269)
[PASS] testEmergencyWithdraw_Unauthorized() (gas: 16322)
[PASS] testFuzz_Stake(uint256) (runs: 256, Î¼: 142237, ~: 142313)
[PASS] testGetStakingStats() (gas: 271287)
[PASS] testGetUserStakeInfo() (gas: 141312)
[PASS] testIntegration_CompleteFlow() (gas: 462332)
[PASS] testIntegration_StakeAndUnstakeMultipleTimes() (gas: 194210)
[PASS] testStake() (gas: 140870)
[PASS] testStake_BelowMinimum() (gas: 49245)
[PASS] testStake_Multiple() (gas: 156342)
[PASS] testStake_MultipleUsers() (gas: 286634)
[PASS] testUnstake_AfterLockPeriod() (gas: 133276)
[PASS] testUnstake_EarlyWithPenalty() (gas: 159628)
[PASS] testUnstake_InsufficientStake() (gas: 134492)
[PASS] testUnstake_InvalidAmount() (gas: 17259)
[PASS] testUnstake_Partial() (gas: 148426)
[PASS] testUpdateParameters() (gas: 33102)
[PASS] testUpdateParameters_InvalidMinStake() (gas: 12341)
[PASS] testUpdateParameters_LockTooLong() (gas: 11769)
[PASS] testUpdateParameters_PenaltyTooHigh() (gas: 11835)
[PASS] testUpdateParameters_Unauthorized() (gas: 14304)
Suite result: ok. 35 passed; 0 failed; 0 skipped; finished in 24.33ms (29.68ms CPU time)

Ran 55 tests for test/TreasuryManager.t.sol:TreasuryManagerTest
[PASS] testAddLiquidity() (gas: 65760)
[PASS] testAddLiquidity_InvalidAmount() (gas: 16554)
[PASS] testAddLiquidity_Multiple() (gas: 79613)
[PASS] testCollectExecutionFee() (gas: 46155)
[PASS] testCollectExecutionFee_InvalidAmount() (gas: 21454)
[PASS] testCollectExecutionFee_Multiple() (gas: 51199)
[PASS] testCollectExecutionFee_Unauthorized() (gas: 14707)
[PASS] testCollectFee() (gas: 68372)
[PASS] testCollectFee_InvalidAmount() (gas: 21794)
[PASS] testCollectFee_Multiple() (gas: 76127)
[PASS] testCollectFee_Unauthorized() (gas: 14277)
[PASS] testDeployment() (gas: 34777)
[PASS] testDeployment_InvalidStaking() (gas: 130838)
[PASS] testDeployment_InvalidTreasury() (gas: 130119)
[PASS] testDeployment_InvalidUSDC() (gas: 130615)
[PASS] testDistributeFees() (gas: 157735)
[PASS] testDistributeFees_NoFeesToDistribute() (gas: 21679)
[PASS] testDistributeFees_Unauthorized() (gas: 68246)
[PASS] testDistributeProfit() (gas: 188685)
[PASS] testDistributeProfit_InsufficientLiquidity() (gas: 24921)
[PASS] testDistributeProfit_InvalidAddress() (gas: 20702)
[PASS] testDistributeProfit_InvalidAmount() (gas: 21656)
[PASS] testEmergencyWithdraw_ERC20() (gas: 34140)
[PASS] testEmergencyWithdraw_InvalidAddress() (gas: 17241)
[PASS] testEmergencyWithdraw_InvalidAmount() (gas: 17285)
[PASS] testEmergencyWithdraw_Unauthorized() (gas: 17222)
[PASS] testFuzz_CollectFee(uint256) (runs: 256, Î¼: 69377, ~: 69486)
[PASS] testFuzz_FeeDistribution(uint256,uint256) (runs: 256, Î¼: 37527, ~: 38009)
[PASS] testGetAvailableLiquidity() (gas: 64455)
[PASS] testGetFeeDistribution() (gas: 14126)
[PASS] testGetPendingExecutionFees() (gas: 45124)
[PASS] testGetPendingFees() (gas: 66225)
[PASS] testGetStatistics() (gas: 297176)
[PASS] testGetTotalBalance() (gas: 12479)
[PASS] testIntegration_CompleteFlow() (gas: 335798)
[PASS] testPayKeeperFee() (gas: 114101)
[PASS] testPayKeeperFee_InsufficientFees() (gas: 25004)
[PASS] testPayKeeperFee_InvalidAmount() (gas: 22751)
[PASS] testPayKeeperFee_InvalidKeeper() (gas: 20233)
[PASS] testRefundCollateral() (gas: 66884)
[PASS] testRefundCollateral_InsufficientBalance() (gas: 26564)
[PASS] testRefundCollateral_InvalidAddress() (gas: 19086)
[PASS] testRefundCollateral_InvalidAmount() (gas: 22108)
[PASS] testRefundCollateral_Multiple() (gas: 76493)
[PASS] testRefundCollateral_Unauthorized() (gas: 14757)
[PASS] testRemoveLiquidity() (gas: 80052)
[PASS] testRemoveLiquidity_InsufficientLiquidity() (gas: 23881)
[PASS] testRemoveLiquidity_Unauthorized() (gas: 14202)
[PASS] testUpdateAddresses() (gas: 34128)
[PASS] testUpdateAddresses_OnlyStaking() (gas: 28363)
[PASS] testUpdateAddresses_OnlyTreasury() (gas: 28323)
[PASS] testUpdateAddresses_Unauthorized() (gas: 18568)
[PASS] testUpdateFeeDistribution() (gas: 36748)
[PASS] testUpdateFeeDistribution_InvalidSum() (gas: 14957)
[PASS] testUpdateFeeDistribution_Unauthorized() (gas: 14052)
Suite result: ok. 55 passed; 0 failed; 0 skipped; finished in 31.15ms (61.29ms CPU time)

Ran 24 tests for test/TethraToken.t.sol:TethraTokenTest
[PASS] testApprove() (gas: 38592)
[PASS] testComplexTransferChain() (gas: 98139)
[PASS] testDeployment() (gas: 20532)
[PASS] testDistributionSum() (gas: 25785)
[PASS] testExactDistributionAmounts() (gas: 26000)
[PASS] testFuzz_ApproveAndTransferFrom(uint256) (runs: 256, Î¼: 55774, ~: 55690)
[PASS] testFuzz_MultipleTransfers(uint8) (runs: 256, Î¼: 61851, ~: 61081)
[PASS] testFuzz_Transfer(uint256) (runs: 256, Î¼: 50087, ~: 49987)
[PASS] testInfiniteApproval() (gas: 75334)
[PASS] testInitialDistribution() (gas: 28891)
[PASS] testInitializeOnlyOnce() (gas: 945043)
[PASS] testMultipleTransfersFromSameSource() (gas: 51987)
[PASS] testNoSupplyIncrease() (gas: 57401)
[PASS] testTransferAllTokens() (gas: 40881)
[PASS] testTransferBetweenUsers() (gas: 71482)
[PASS] testTransferFrom() (gas: 51777)
[PASS] testTransferFromInsufficientAllowance() (gas: 39606)
[PASS] testTransferFromLiquidityMining() (gas: 44958)
[PASS] testTransferFromStakingRewards() (gas: 44015)
[PASS] testTransferFromTeam() (gas: 44169)
[PASS] testTransferFromTreasury() (gas: 43438)
[PASS] testTransferInsufficientBalance() (gas: 15801)
[PASS] testTransferToZeroAddress() (gas: 12083)
[PASS] testZeroAddressRejection() (gas: 3252058)
Suite result: ok. 24 passed; 0 failed; 0 skipped; finished in 34.23ms (64.52ms CPU time)

Ran 3 tests for test/LimitExecutorV2.t.sol:LimitExecutorV2Test
[PASS] testExecuteLimitOpenOrderPullsOnlyCollateral() (gas: 715354)
[PASS] testLimitCloseOrderChargesTradingFeeOnClose() (gas: 1104797)
[PASS] testStopLossCapsLossAtNinetyNinePercent() (gas: 1107586)
Suite result: ok. 3 passed; 0 failed; 0 skipped; finished in 35.18ms (8.99ms CPU time)

Ran 19 tests for test/MockUSDC.t.sol:MockUSDCTest
[PASS] testApprove() (gas: 38575)
[PASS] testDeployment() (gas: 17817)
[PASS] testFaucetClaim() (gas: 65461)
[PASS] testFaucetMultipleUsers() (gas: 118019)
[PASS] testFaucetOnlyOnce() (gas: 66575)
[PASS] testFuzz_MintAmount(uint256) (runs: 256, Î¼: 44140, ~: 44026)
[PASS] testFuzz_Transfer(uint256) (runs: 256, Î¼: 56744, ~: 56676)
[PASS] testHasClaimedStatus() (gas: 66751)
[PASS] testMintAsNonOwner() (gas: 15281)
[PASS] testMintAsOwner() (gas: 40853)
[PASS] testMintToZeroAddress() (gas: 11028)
[PASS] testMultipleApprovalsAndTransfers() (gas: 85321)
[PASS] testMultipleFaucetClaimsReset() (gas: 268232)
[PASS] testResetFaucetClaim() (gas: 76736)
[PASS] testTransfer() (gas: 72741)
[PASS] testTransferFrom() (gas: 78595)
[PASS] testTransferFromInsufficientAllowance() (gas: 71705)
[PASS] testTransferInsufficientBalance() (gas: 46044)
[PASS] testTransferToZeroAddress() (gas: 44238)
Suite result: ok. 19 passed; 0 failed; 0 skipped; finished in 35.12ms (41.39ms CPU time)

Ran 43 tests for test/LiquidityMining.t.sol:LiquidityMiningTest
[PASS] testAddLiquidity() (gas: 143405)
[PASS] testAddLiquidity_BelowMinimum() (gas: 48600)
[PASS] testAddLiquidity_Multiple() (gas: 158210)
[PASS] testAddLiquidity_MultipleProviders() (gas: 289841)
[PASS] testCalculateAPR() (gas: 134667)
[PASS] testCalculateAPR_NoLiquidity() (gas: 8799)
[PASS] testClaimRewards() (gas: 252318)
[PASS] testClaimRewards_Multiple() (gas: 252315)
[PASS] testClaimRewards_NoRewards() (gas: 139365)
[PASS] testDeployment() (gas: 30785)
[PASS] testDeployment_InvalidTetra() (gas: 173589)
[PASS] testDeployment_InvalidUsdc() (gas: 174216)
[PASS] testDepositRewardTokens() (gas: 64545)
[PASS] testDepositRewardTokens_InvalidAmount() (gas: 11965)
[PASS] testDepositRewardTokens_Unauthorized() (gas: 13906)
[PASS] testEmergencyWithdraw() (gas: 58386)
[PASS] testEmergencyWithdraw_InvalidAddress() (gas: 13989)
[PASS] testEmergencyWithdraw_InvalidAmount() (gas: 16143)
[PASS] testEmergencyWithdraw_InvalidToken() (gas: 13467)
[PASS] testEmergencyWithdraw_Unauthorized() (gas: 16520)
[PASS] testFuzz_AddLiquidity(uint256) (runs: 256, Î¼: 144380, ~: 144447)
[PASS] testFuzz_Rewards(uint256) (runs: 256, Î¼: 144558, ~: 144618)
[PASS] testGetMiningStats() (gas: 245029)
[PASS] testGetProviderInfo() (gas: 144177)
[PASS] testIntegration_AddRemoveMultipleTimes() (gas: 262531)
[PASS] testIntegration_CompleteFlow() (gas: 423096)
[PASS] testRemoveLiquidity_AfterLockPeriod() (gas: 135765)
[PASS] testRemoveLiquidity_EarlyWithPenalty() (gas: 148662)
[PASS] testRemoveLiquidity_InsufficientLiquidity() (gas: 136211)
[PASS] testRemoveLiquidity_InvalidAmount() (gas: 17457)
[PASS] testRemoveLiquidity_Partial() (gas: 151059)
[PASS] testRewards_MultipleProviders() (gas: 216044)
[PASS] testRewards_SingleProvider() (gas: 141860)
[PASS] testUpdateEmissionRate() (gas: 23232)
[PASS] testUpdateEmissionRate_InvalidRate() (gas: 11163)
[PASS] testUpdateEmissionRate_RateTooHigh() (gas: 11977)
[PASS] testUpdateEmissionRate_Unauthorized() (gas: 13692)
[PASS] testUpdateParameters() (gas: 33498)
[PASS] testUpdateParameters_InvalidMinDeposit() (gas: 11311)
[PASS] testUpdateParameters_LockTooLong() (gas: 11945)
[PASS] testUpdateParameters_PenaltyTooHigh() (gas: 12059)
[PASS] testUpdateParameters_Unauthorized() (gas: 14502)
[PASS] testUpdatePool() (gas: 168938)
Suite result: ok. 43 passed; 0 failed; 0 skipped; finished in 43.92ms (69.28ms CPU time)

Ran 58 tests for test/USDCPaymaster.t.sol:USDCPaymasterTest
[PASS] testCalculateUsdcCost() (gas: 10445)
[PASS] testCalculateUsdcCost_LargeAmount() (gas: 11343)
[PASS] testDeployment() (gas: 21788)
[PASS] testDeployment_InvalidRate() (gas: 129037)
[PASS] testDeployment_InvalidUSDC() (gas: 127270)
[PASS] testDeposit_BelowMinimum() (gas: 20140)
[PASS] testDeposit_Multiple() (gas: 85002)
[PASS] testDeposit_MultipleUsers() (gas: 119310)
[PASS] testDeposit_Success() (gas: 81956)
[PASS] testExchangeRateAffectsGasCost() (gas: 90552)
[PASS] testFundPaymaster_NoValue() (gas: 10941)
[PASS] testFundPaymaster_Success() (gas: 16510)
[PASS] testFuzz_Deposit(uint256) (runs: 256, Î¼: 80854, ~: 80861)
[PASS] testFuzz_ExchangeRate(uint256) (runs: 256, Î¼: 22987, ~: 22982)
[PASS] testFuzz_GasPayment(uint256) (runs: 256, Î¼: 114458, ~: 114450)
[PASS] testGetRateInfo() (gas: 11615)
[PASS] testGetTotalBalance() (gas: 115761)
[PASS] testGetUserDeposit() (gas: 81834)
[PASS] testIntegration_CompleteFlow() (gas: 146325)
[PASS] testIntegration_MultipleUsers() (gas: 157341)
[PASS] testPremiumAffectsGasCost() (gas: 20485)
[PASS] testProcessGasPayment_InsufficientDeposit() (gas: 89078)
[PASS] testProcessGasPayment_InvalidUser() (gas: 19047)
[PASS] testProcessGasPayment_MultipleTransactions() (gas: 118810)
[PASS] testProcessGasPayment_NoGasUsed() (gas: 21134)
[PASS] testProcessGasPayment_NotAllowedExecutor() (gas: 84865)
[PASS] testProcessGasPayment_Success() (gas: 115764)
[PASS] testReceiveNative() (gas: 12442)
[PASS] testSetExecutorStatus_Allow() (gas: 40299)
[PASS] testSetExecutorStatus_InvalidAddress() (gas: 12045)
[PASS] testSetExecutorStatus_Revoke() (gas: 19185)
[PASS] testSetExecutorStatus_Unauthorized() (gas: 16065)
[PASS] testUpdateExchangeRate_InvalidRate() (gas: 11581)
[PASS] testUpdateExchangeRate_Success() (gas: 20937)
[PASS] testUpdateExchangeRate_Unauthorized() (gas: 14695)
[PASS] testUpdateMinDeposit_Invalid() (gas: 12488)
[PASS] testUpdateMinDeposit_Success() (gas: 14462)
[PASS] testUpdateMinDeposit_Unauthorized() (gas: 14033)
[PASS] testUpdatePremium_Success() (gas: 20291)
[PASS] testUpdatePremium_TooHigh() (gas: 11817)
[PASS] testUpdatePremium_Unauthorized() (gas: 13991)
[PASS] testValidateGasPayment_InsufficientDeposit() (gas: 80531)
[PASS] testValidateGasPayment_InvalidUser() (gas: 6811)
[PASS] testValidateGasPayment_Success() (gas: 81393)
[PASS] testValidateGasPayment_ZeroGas() (gas: 8324)
[PASS] testWithdrawNative_InsufficientBalance() (gas: 14443)
[PASS] testWithdrawNative_InvalidAddress() (gas: 11682)
[PASS] testWithdrawNative_InvalidAmount() (gas: 13461)
[PASS] testWithdrawNative_Success() (gas: 55028)
[PASS] testWithdrawUsdc_ExceedsCollected() (gas: 22121)
[PASS] testWithdrawUsdc_InvalidAddress() (gas: 17671)
[PASS] testWithdrawUsdc_InvalidAmount() (gas: 19821)
[PASS] testWithdrawUsdc_Success() (gas: 131111)
[PASS] testWithdrawUsdc_Unauthorized() (gas: 13826)
[PASS] testWithdraw_FullAmount() (gas: 66869)
[PASS] testWithdraw_InsufficientBalance() (gas: 80010)
[PASS] testWithdraw_InvalidAmount() (gas: 80188)
[PASS] testWithdraw_Success() (gas: 90633)
Suite result: ok. 58 passed; 0 failed; 0 skipped; finished in 45.12ms (72.11ms CPU time)

Ran 37 tests for test/PositionManager.t.sol:PositionManagerTest
[PASS] testCalculatePnL_InvalidPrice() (gas: 278868)
[PASS] testCalculatePnL_Long_Loss() (gas: 278203)
[PASS] testCalculatePnL_Long_Profit() (gas: 278870)
[PASS] testCalculatePnL_NoChange() (gas: 278524)
[PASS] testCalculatePnL_PositionNotFound() (gas: 31000)
[PASS] testCalculatePnL_Short_Loss() (gas: 257767)
[PASS] testCalculatePnL_Short_Profit() (gas: 258175)
[PASS] testClosePosition_AlreadyClosed() (gas: 306425)
[PASS] testClosePosition_InvalidExitPrice() (gas: 280909)
[PASS] testClosePosition_Long_Loss() (gas: 300927)
[PASS] testClosePosition_Long_Profit() (gas: 308625)
[PASS] testClosePosition_NotFound() (gas: 20859)
[PASS] testClosePosition_Short_Loss() (gas: 280875)
[PASS] testClosePosition_Short_Profit() (gas: 281892)
[PASS] testClosePosition_Unauthorized() (gas: 278410)
[PASS] testCreatePosition_InvalidCollateral() (gas: 21965)
[PASS] testCreatePosition_InvalidLeverage() (gas: 22349)
[PASS] testCreatePosition_InvalidPrice() (gas: 22308)
[PASS] testCreatePosition_InvalidTrader() (gas: 20464)
[PASS] testCreatePosition_Long() (gas: 287727)
[PASS] testCreatePosition_MultiplePositions() (gas: 490675)
[PASS] testCreatePosition_Short() (gas: 259734)
[PASS] testCreatePosition_Unauthorized() (gas: 15131)
[PASS] testDeployment() (gas: 17338)
[PASS] testFuzz_CalculatePnL(uint256,uint256,bool) (runs: 256, Î¼: 274262, ~: 283001)
[PASS] testFuzz_CreatePosition(uint256,uint256,uint256) (runs: 256, Î¼: 285675, ~: 285705)
[PASS] testGetPositionStatus() (gas: 304075)
[PASS] testGetPositionStatus_NotFound() (gas: 11796)
[PASS] testGetUserOpenPositions() (gas: 779228)
[PASS] testGetUserOpenPositions_AllClosed() (gas: 543092)
[PASS] testGetUserOpenPositions_NoPositions() (gas: 11684)
[PASS] testGetUserPositions() (gas: 746887)
[PASS] testLiquidatePosition() (gas: 306039)
[PASS] testLiquidatePosition_AlreadyClosed() (gas: 306101)
[PASS] testLiquidatePosition_NotFound() (gas: 21145)
[PASS] testLiquidatePosition_Unauthorized() (gas: 279039)
[PASS] testPositionExists() (gas: 279818)
Suite result: ok. 37 passed; 0 failed; 0 skipped; finished in 47.21ms (72.68ms CPU time)

Ran 12 test suites in 48.09ms (333.16ms CPU time): 324 tests passed, 8 failed, 0 skipped (332 total tests)

Failing tests:
Encountered 7 failing tests in test/LimitExecutor.t.sol:LimitExecutorTest
[FAIL: Error != expected error: ECDSAInvalidSignatureLength(1) != LimitExecutor: Price not reached (long)] testCannotExecuteBeforePriceReaches_Long() (gas: 351329)
[FAIL: ECDSAInvalidSignatureLength(1)] testCreateStopLossOrder() (gas: 350872)
[FAIL: ECDSAInvalidSignatureLength(1)] testCreateTakeProfitOrder() (gas: 351514)
[FAIL: log != expected log] testExecuteLimitOpenOrder_Long() (gas: 354014)
[FAIL: ECDSAInvalidSignatureLength(1)] testExecuteLimitOpenOrder_Short() (gas: 331297)
[FAIL: ECDSAInvalidSignatureLength(1)] testExecuteStopLoss_LongPosition() (gas: 350682)
[FAIL: ECDSAInvalidSignatureLength(1)] testExecuteTakeProfit_LongPosition() (gas: 350937)

Encountered 1 failing test in test/RiskManager.t.sol:RiskManagerTest
[FAIL: Loss below 99% should not liquidate] testShouldLiquidateRespectsBuffer() (gas: 10075)

Encountered a total of 8 failing tests, 324 tests succeeded
